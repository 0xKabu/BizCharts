<html>
  <head>
    <script src="https://unpkg.com/react@15/dist/react.min.js"></script>
    <script src="https://unpkg.com/react-dom@15/dist/react-dom.min.js"></script>
	  <script type="text/javascript" src="https://gw.alipayobjects.com/os/antv/assets/data-set/0.7.0/data-set.min.js"></script>
    <script src="https://cdn.bootcss.com/babel-core/5.8.38/browser.min.js"></script>
    <script src="https://unpkg.alipay.com/bizcharts@3.0.4/umd/BizCharts.js"> </script>
    <script type="text/javascript" src="https://gw.alipayobjects.com/as/g/datavis/assets/1.0.1/jquery-3.2.1.min.js"></script>

  </head>
  <body>

   <div id="c1" ></div>
   <script type="text/babel">

  $.getJSON('/public/data/flare.json', data => {
    const { Chart, Axis, Geom, Tooltip, Facet, View, Legend, Label, Coord } = window.BizCharts;
    const dv = new DataSet.View().source(data, {
          type: 'hierarchy'
      });
      dv.transform({
          type: 'hierarchy.tree'
      });

    ReactDOM.render(
      <Chart forceFit={true} height={window.innerHeight} data padding={[ 50, 0, 20, 0 ]} >
        <Coord type="polar" />
        <Tooltip showTitle={false} />
        <View data={dv.getAllLinks().map(link => ({
            x: [ link.source.x, link.target.x ],
            y: [ link.source.y, link.target.y ],
            source: link.source.id,
            target: link.target.id
        }))}>
          <Geom type='edge' position='x*y' shape='smooth' color='grey' opacity={0.5} tooltip='source*target'
          />
        </View>
        <View data={dv.getAllNodes().map(node => ({
            hasChildren: !!(node.data.children && node.data.children.length),
            name: node.data.name,
            value: node.value,
            depth: node.depth,
            x: node.x,
            y: node.y
        }))}>
          <Geom type='point' position='x*y' color='hasChildren' >
            <Label 
            content="name"
            offset={0}
            labelEmit
            textStyle={(text, item) => {
              let textAlign = item.textAlign;
              if (item.point.hasChildren) {
                  textAlign = textAlign === 'left' ? 'right' : 'left';
              }
              return {
                  fill: 'grey',
                  fontSize: 9,
                  textAlign
              };
          }}
            />
          </Geom>  
        </View>
      </Chart>, document.getElementById('c1')
    );

  })
    </script>
  </body>
</html>